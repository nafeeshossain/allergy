{% extends "base.html" %}
{% block content %}
<div style="text-align:center; margin-bottom: 40px;">
  <h1 style="font-weight:700; color:#2563eb;">🌍 Community Insights</h1>
  <p style="color:#555;">See what the community is reporting and sharing in real-time 🚀</p>
</div>

<div class="card" style="padding:24px; border-radius:16px; background:#fff; box-shadow:0 6px 16px rgba(0,0,0,0.08);">
  
  <!-- Top reported products -->
  <h2 style="color:#333; margin-bottom:12px;">📊 Top Reported Products</h2>
  <table style="width:100%; border-collapse:collapse; font-size:1rem;">
    <thead>
      <tr style="background:#f3f4f6; text-align:left;">
        <th style="padding:12px; border-radius:8px 0 0 8px;">Product</th>
        <th style="padding:12px; border-radius:0 8px 8px 0;">Reports</th>
      </tr>
    </thead>
    <tbody>
    {% for p in agg %}
      <tr style="border-bottom:1px solid #eee;">
        <td style="padding:10px;">{{ p.product_name }}</td>
        <td style="padding:10px; font-weight:600; color:#2563eb;">{{ p.cnt }}</td>
      </tr>
    {% else %}
      <tr><td colspan="2" style="padding:12px; text-align:center; color:#777;">No reports yet.</td></tr>
    {% endfor %}
    </tbody>
  </table>

  <!-- Divider -->
  <hr style="margin:30px 0; border:none; border-top:2px dashed #ddd;">

  <!-- Recent Feedback -->
  <h2 style="color:#333; margin-bottom:12px;">📝 Recent Feedback</h2>
  <table style="width:100%; border-collapse:collapse; font-size:0.95rem;">
    <thead>
      <tr style="background:#f3f4f6; text-align:left;">
        <th style="padding:10px;">Time</th>
        <th style="padding:10px;">User</th>
        <th style="padding:10px;">Product</th>
        <th style="padding:10px;">Reaction</th>
        <th style="padding:10px;">Notes</th>
      </tr>
    </thead>
    <tbody>
    {% for r in recent %}
      <tr style="border-bottom:1px solid #eee;">
        <td style="padding:10px; color:#666;">{{ r.timestamp }}</td>
        <td style="padding:10px; font-weight:600;">{{ r.username }}</td>
        <td style="padding:10px;">{{ r.product_name }}</td>
        <td style="padding:10px;">{{ r.reaction }}</td>
        <td style="padding:10px; color:#444;">{{ r.notes }}</td>
      </tr>
    {% else %}
      <tr><td colspan="5" style="padding:12px; text-align:center; color:#777;">No feedback yet.</td></tr>
    {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
